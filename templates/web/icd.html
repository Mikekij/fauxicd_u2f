{% extends 'base.html' %}

{% block title %}FauxICD{% endblock %}

{% block body_block %}




  <div class="row">
    <div class="col-md-6">

      {% if icd %}
        <b>Name:</b> {{ icd.name }}<br />
        <b>Zap Duration:</b> {{ icd.zap_duration }} ms<br />
        <b>Encryption Keys Required:</b> {{ icd.keys_required }}<br />
      {% endif %}

      <div>
        <a href="{% url 'edit_icd' id=icd.id %}" >Edit</a> | <a href="{% url 'icd_index' %}" >List All ICDs</a> |
        <a href="#" id="check_perms">Check Permissions</a>
      </div>
    </div><!-- /.col-md-6 -->

    <div class="col-md-6">
      <div class="jumbotron">
        <div class="btn btn-danger{% if not user.is_authenticated %} disabled{% endif %}" id="shock-button">Deliver Shock</div>
      </div><!-- /.jumbotron -->
    </div><!-- /.col-md-6 -->
  </div><!--/row-->

  <script>
  $("#shock-button").click(function(){
    $.get("{% url 'deliver_shock_ajax' %}", function(data){
      results = JSON.parse(data);
      alert(results.message);
    });
  });

  $( "#check_perms" ).click(function() {
    url = "http://localhost:3000/permissions_check?format=json";
    user_id = "&user_id=1";
    mcaction_id = "&mcaction_id=5"
    $.getJSON(url + user_id + mcaction_id,function(data) {
      alert("User has permission:" + data);
    });
  });

  </script>

{% endblock %}
